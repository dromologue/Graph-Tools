<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Graph Visualizer</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .graph-container {
            display: flex;
            gap: 20px;
            padding: 20px;
        }
        
        .graph-svg {
            flex: 1;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #fafafa;
        }
        
        .graph-info {
            width: 300px;
            background: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        
        .node {
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .node:hover {
            transform: scale(1.1);
        }
        
        .node-circle {
            fill: #4CAF50;
            stroke: #45a049;
            stroke-width: 2;
        }
        
        .node-text {
            font-size: 14px;
            font-weight: bold;
            fill: white;
            text-anchor: middle;
            dominant-baseline: central;
        }
        
        .edge {
            stroke: #666;
            stroke-width: 2;
            marker-end: url(#arrowhead);
        }
        
        .edge-weighted {
            stroke: #e74c3c;
            stroke-width: 3;
        }
        
        .edge-label {
            font-size: 12px;
            fill: #e74c3c;
            font-weight: bold;
            text-anchor: middle;
            dominant-baseline: central;
        }
        
        .info-section {
            margin-bottom: 20px;
        }
        
        .info-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 5px;
        }
        
        .info-item {
            margin: 5px 0;
            padding: 5px;
            background: white;
            border-radius: 4px;
        }
        
        .controls {
            padding: 20px;
            background: #f9f9f9;
            border-top: 1px solid #ddd;
        }
        
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-right: 10px;
            font-size: 14px;
        }
        
        button:hover {
            background: #5a6fd8;
        }
        
        input[type="file"] {
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const GraphVisualizer = () => {
            const [graphData, setGraphData] = useState({
                nodes: [],
                edges: [],
                properties: { vertices: 0, edges: 0, density: 0 }
            });
            const [selectedNode, setSelectedNode] = useState(null);
            const fileInputRef = useRef(null);

            const sampleGraph = {
                nodes: [
                    { id: "A", label: "A", x: 350, y: 50 },
                    { id: "B", label: "B", x: 150, y: 200 },
                    { id: "C", label: "C", x: 550, y: 200 },
                    { id: "D", label: "D", x: 350, y: 350 }
                ],
                edges: [
                    { from: "A", to: "B", weight: 1, label: "" },
                    { from: "A", to: "C", weight: 1, label: "" },
                    { from: "B", to: "A", weight: 1, label: "" },
                    { from: "B", to: "C", weight: 1, label: "" },
                    { from: "B", to: "D", weight: 1, label: "" },
                    { from: "C", to: "A", weight: 1, label: "" },
                    { from: "C", to: "B", weight: 1, label: "" },
                    { from: "C", to: "D", weight: 1, label: "" },
                    { from: "D", to: "B", weight: 1, label: "" },
                    { from: "D", to: "C", weight: 1, label: "" }
                ],
                properties: { vertices: 4, edges: 10, density: 0.833 }
            };

            useEffect(() => {
                setGraphData(sampleGraph);
            }, []);

            const loadJsonFile = (event) => {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const data = JSON.parse(e.target.result);
                            setGraphData(data);
                        } catch (error) {
                            alert('Error parsing JSON file: ' + error.message);
                        }
                    };
                    reader.readAsText(file);
                }
            };

            const getNodeNeighbors = (nodeId) => {
                return graphData.edges
                    .filter(edge => edge.from === nodeId)
                    .map(edge => edge.to);
            };

            const getNodeConnections = (nodeId) => {
                return graphData.edges.filter(edge => 
                    edge.from === nodeId || edge.to === nodeId
                );
            };

            const renderEdges = () => {
                return graphData.edges.map((edge, index) => {
                    const fromNode = graphData.nodes.find(n => n.id === edge.from);
                    const toNode = graphData.nodes.find(n => n.id === edge.to);
                    
                    if (!fromNode || !toNode) return null;

                    const dx = toNode.x - fromNode.x;
                    const dy = toNode.y - fromNode.y;
                    const length = Math.sqrt(dx * dx + dy * dy);
                    const unitX = dx / length;
                    const unitY = dy / length;
                    
                    const startX = fromNode.x + unitX * 25;
                    const startY = fromNode.y + unitY * 25;
                    const endX = toNode.x - unitX * 25;
                    const endY = toNode.y - unitY * 25;
                    
                    const midX = (startX + endX) / 2;
                    const midY = (startY + endY) / 2;

                    return (
                        <g key={index}>
                            <line
                                x1={startX}
                                y1={startY}
                                x2={endX}
                                y2={endY}
                                className={edge.weight > 1 ? 'edge edge-weighted' : 'edge'}
                            />
                            {edge.label && (
                                <text
                                    x={midX}
                                    y={midY}
                                    className="edge-label"
                                >
                                    {edge.label}
                                </text>
                            )}
                        </g>
                    );
                });
            };

            const renderNodes = () => {
                return graphData.nodes.map((node) => (
                    <g
                        key={node.id}
                        className="node"
                        onClick={() => setSelectedNode(node.id)}
                    >
                        <circle
                            cx={node.x}
                            cy={node.y}
                            r="25"
                            className="node-circle"
                            style={{
                                fill: selectedNode === node.id ? '#ff6b6b' : '#4CAF50'
                            }}
                        />
                        <text
                            x={node.x}
                            y={node.y}
                            className="node-text"
                        >
                            {node.label}
                        </text>
                    </g>
                ));
            };

            return (
                <div className="container">
                    <div className="header">
                        <h1>Graph Visualizer</h1>
                        <p>Interactive visualization of graph structures from adjacency matrices</p>
                    </div>
                    
                    <div className="graph-container">
                        <svg className="graph-svg" width="600" height="400">
                            <defs>
                                <marker
                                    id="arrowhead"
                                    markerWidth="10"
                                    markerHeight="7"
                                    refX="9"
                                    refY="3.5"
                                    orient="auto"
                                >
                                    <polygon
                                        points="0 0, 10 3.5, 0 7"
                                        fill="#666"
                                    />
                                </marker>
                            </defs>
                            {renderEdges()}
                            {renderNodes()}
                        </svg>
                        
                        <div className="graph-info">
                            <div className="info-section">
                                <div className="info-title">Graph Properties</div>
                                <div className="info-item">Vertices: {graphData.properties.vertices}</div>
                                <div className="info-item">Edges: {graphData.properties.edges}</div>
                                <div className="info-item">Density: {graphData.properties.density}</div>
                            </div>
                            
                            <div className="info-section">
                                <div className="info-title">Vertices</div>
                                {graphData.nodes.map(node => (
                                    <div
                                        key={node.id}
                                        className="info-item"
                                        style={{
                                            backgroundColor: selectedNode === node.id ? '#ffe6e6' : 'white',
                                            cursor: 'pointer'
                                        }}
                                        onClick={() => setSelectedNode(node.id)}
                                    >
                                        <strong>{node.label}</strong>
                                        <div style={{fontSize: '12px', color: '#666'}}>
                                            Neighbors: {getNodeNeighbors(node.id).join(', ') || 'None'}
                                        </div>
                                    </div>
                                ))}
                            </div>
                            
                            {selectedNode && (
                                <div className="info-section">
                                    <div className="info-title">Selected: {selectedNode}</div>
                                    <div className="info-item">
                                        <div>Connections:</div>
                                        {getNodeConnections(selectedNode).map((conn, i) => (
                                            <div key={i} style={{fontSize: '12px', marginLeft: '10px'}}>
                                                {conn.from} → {conn.to} {conn.weight > 1 ? `(${conn.weight})` : ''}
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                    
                    <div className="controls">
                        <input
                            type="file"
                            accept=".json"
                            onChange={loadJsonFile}
                            ref={fileInputRef}
                        />
                        <button onClick={() => fileInputRef.current?.click()}>
                            Load Graph JSON
                        </button>
                        <button onClick={() => setGraphData(sampleGraph)}>
                            Load Sample Graph
                        </button>
                        <button onClick={() => setSelectedNode(null)}>
                            Clear Selection
                        </button>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<GraphVisualizer />, document.getElementById('root'));
    </script>
</body>
</html>